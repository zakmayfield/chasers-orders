import './globals.css';

import type { Metadata } from 'next';

import { ToastContainer } from 'react-toastify';
import { ReactQueryDevtools } from '@tanstack/react-query-devtools';

import { Header } from '@/features/core/header';
import { Footer } from '@/features/core/footer';
import { CoreProvider } from '@/lib/providers/CoreProvider';
import { getAuthSession } from '@/lib/auth/auth.options';
import { quicksand } from '@/utils/fonts';

export const metadata: Metadata = {
  title: 'Create Next App',
  description: 'Generated by create next app',
};

export default async function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  const session = await getAuthSession();
  const isAuth = !!session?.user;
  return (
    <html lang='en'>
      <CoreProvider>
        <body className={quicksand.className}>
          {isAuth && <Header />}

          {/* Pages Container */}
          <div className='py-6 min-h-screen'>{children}</div>
          <ToastContainer limit={4} autoClose={3000} position='bottom-right' />

          {/* Dev Tools */}
          <ReactQueryDevtools initialIsOpen={false} />

          {isAuth && <Footer />}
        </body>
      </CoreProvider>
    </html>
  );
}
